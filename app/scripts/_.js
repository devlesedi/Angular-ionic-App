var app=angular.module("app",["ngRoute","ngCookies","LocalStorageModule","main","home","about","api","signIn","register","jobDetails","postJob","angularMoment",]);app.config(["$routeProvider","$locationProvider","$httpProvider","localStorageServiceProvider",function(n,t,i){t.hashPrefix("!");i.responseInterceptors.push(["$q","$location",function(n,t){return function(i){return i.then(function(n){return n},function(i){return i.status===401&&t.url("/signin"),n.reject(i)})}}]);n.when("/",{templateUrl:"App/Home",controller:"homeCtrl"});n.when("/jobs/:jobType/:location",{templateUrl:"App/Home",controller:"homeCtrl"});n.when("/jobs/:jobType",{templateUrl:"App/Home",controller:"homeCtrl"});n.when("/register",{templateUrl:"App/Register",controller:"registerCtrl"});n.when("/signin",{templateUrl:"App/SignIn",controller:"signInCtrl"});n.when("/todomanager",{templateUrl:"App/TodoManager",controller:"todoManagerCtrl"});n.when("/jobdetails/:jobId",{templateUrl:"App/JobDetails",controller:"jobDetailsCtrl"});n.when("/postjob",{templateUrl:"App/PostJob",controller:"postJobCtrl"});n.when("/about",{templateUrl:"App/About",controller:"aboutCtrl"});n.when("/api",{templateUrl:"App/Api",controller:"apiCtrl"});n.otherwise({redirectTo:"/"})}]);app.run(["$http","$cookies","$cookieStore",function(n,t,i){n.defaults.headers.common.Authorization="Bearer "+i.get("_Token")}]);angular.module("about",[]).controller("aboutCtrl",["$scope",function(){}]);angular.module("api",[]).controller("apiCtrl",["$scope",function(){}]);angular.module("home",[])
.controller("homeCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(n,t,i,r,u){function f(){for(var t=["london","europe","us","remote"],i=u.location,n=0;n<t.length;n++)return i==t[n]?!0:!1}function e(){var n=u.jobType;return n=="inbox"||n=="contract"||n=="permanent"||n=="part-time"||n=="full-time"||n=="freelance"?!0:!1}if(n.jobsList=[],u.jobType)switch(u.jobType){case"inbox":u.location?(n.$parent.searchBy={},n.$parent.searchBy.jobLocation=u.location):n.$parent.searchBy=null;break;case"filter":u.location?(n.$parent.searchBy={},n.$parent.query=u.location):n.$parent.searchBy=null;break;case"starred":n.$parent.searchBy.starred=u.jobType;break;default:n.$parent.searchBy={};e()&&(n.$parent.searchBy.jobType=u.jobType=="freelance"?"freelance":u.jobType=="remote"?"freelance":u.jobType);f()&&(n.$parent.searchBy.jobLocation=u.location)}else n.$parent.searchBy=null;console.log("$routeParams.jobType=%s; $routeParams.location=%s",u.jobType,u.location);n.reset=function(){n.$parent.query="";console.log("reset called")};n.getJobsList=function(){i.get("/api/Jobs/GetJobsList").success(function(t){n.jobsList=t})};n.goTo=function(n){r.path(n)};n.getJobsList();n.locationFilters=["london","europe","us","remote"]}]);
angular.module("jobDetails",["ngSanitize"]).controller("jobDetailsCtrl",["$scope","$http","$routeParams",function(n,t,i){n.details={};n.applicant={};n.getJobDetails=function(i){t.get("/api/Jobs/GetJobDetails",{params:{id:i}}).success(function(t){n.details=t})};n.getJobDetails(i.jobId);n.salary=function(){var i="£",t=n.details.salaryMin,r=n.details.salaryMax;return i+=r&&t?t+" - £"+r:t?t:r,n.details.salaryType&&(i+=" per "+n.details.salaryType),i};n.applyForJob=function(){item={email:n.applicant.email,skills:n.applicant.skills,experience:n.applicant.experience,message:n.applicant.message,jobPostId:n.details.id};n.applicant.email!=""&&t.post("/api/Jobs/ApplyForJob",item).success(function(){n.applicant.message="";n.applied=!0;n.apply=!1})}}]);
app.factory("mails",["$http",function(n){var i=n.get("js/app/mail/mails.json").then(function(n){return n.data.mails}),t={};return t.all=function(){return i},t.get=function(n){return i.then(function(t){for(var i=0;i<t.length;i++)if(t[i].id==n)return t[i];return null})},t}]);app.controller("mailCtrl",["$scope",function(n){n.folds=[{name:"Inbox",filter:""},{name:"Starred",filter:"starred"},{name:"Sent",filter:"sent"},{name:"Important",filter:"important"},{name:"Draft",filter:"draft"},{name:"Trash",filter:"trash"}];n.labels=[{name:"Angular",filter:"angular",color:"#23b7e5"},{name:"Bootstrap",filter:"bootstrap",color:"#7266ba"},{name:"Client",filter:"client",color:"#fad733"},{name:"Work",filter:"work",color:"#27c24c"}];n.addLabel=function(){n.labels.push({name:n.newLabel.name,filter:angular.lowercase(n.newLabel.name),color:"#ccc"});n.newLabel.name=""};n.labelClass=function(n){return{"b-l-info":angular.lowercase(n)==="angular","b-l-primary":angular.lowercase(n)==="bootstrap","b-l-warning":angular.lowercase(n)==="client","b-l-success":angular.lowercase(n)==="work"}}}]);app.controller("MailListCtrl",["$scope","mails","$stateParams",function(n,t,i){n.fold=i.fold;t.all().then(function(t){n.mails=t})}]);app.controller("MailDetailCtrl",["$scope","mails","$stateParams",function(n,t,i){t.get(i.mailId).then(function(t){n.mail=t})}]);app.controller("MailNewCtrl",["$scope",function(n){n.mail={to:"",subject:"",content:""};n.tolist=[{name:"James",email:"james@gmail.com"},{name:"Luoris Kiso",email:"luoris.kiso@hotmail.com"},{name:"Lucy Yokes",email:"lucy.yokes@gmail.com"}]}]);angular.module("app").directive("labelColor",function(){return function(n,t,i){t.css({color:i.color})}});angular.module("main",["ngCookies"]).controller("mainCtrl",["$scope","$rootScope","$http","$cookies","$cookieStore","$location","$routeParams","localStorageService",function(n,t,i,r,u,f,e,o){n.query="";n.searchByTemp={};o.get("myFilters")==null&&(n.myNewFilter="python");n.myFilters=o.get("myFilters")||[];n.addFilter=function(){var t=encodeURIComponent(n.myNewFilter);n.myFilters.indexOf(t)==-1&&(n.myFilters.push(t),o.set("myFilters",n.myFilters),window.location="#!/jobs/filter/"+t,n.myNewFilter="")};n.decodeUriComponent=function(n){return decodeURIComponent(n)};n.removeFilter=function(t){console.log("remove filter: %s",t);n.myFilters.splice(t,1);o.set("myFilters",n.myFilters);window.location="#!/jobs/inbox"};Object.defineProperty(n,"searchBy",{get:function(){return n.query?n.query:n.searchByTemp},set:function(t){typeof t=="object"&&(n.query="",n.searchByTemp=t)}});n.logout=function(){i.defaults.headers.common.Authorization=null;n.password=null;u.remove("_Token");f.path()==="/signin"?n.getUserName():window.location="#/signin"};n.getUserName=function(){i.get("/api/WS_Account/GetCurrentUserName").success(function(t){t!="null"?(n.loggedIn=!0,n.username=t.replace(/["']{1}/gi,"")):n.loggedIn=!1})};n.$on("$locationChangeSuccess",function(){n.activePath=f.path()})}]);angular.module("postJob",["textAngular"]).controller("postJobCtrl",["$scope","$http","$location",function(n,t,i){n.jobPost={htmlContent:"Click here..."};n.saveJob=function(){var r=n.jobPost.expiresOn;r&&(moment(r,"MM/DD").isValid()?r=moment(r,"MM/DD"):moment(r,"YYYY/MM/DD").isValid()&&(r=moment(r,"YYYY/MM/DD")),moment().diff(r,"days")>0&&(r=r.add(1,"year")));item={jobTitle:n.jobPost.jobTitle,jobType:n.jobPost.jobType,jobDescription:n.jobPost.htmlContent,jobEmail:n.jobPost.jobEmail,jobLocation:n.jobPost.jobLocation,hiringCompany:n.jobPost.hiringCompany,hiringCompanyWebsite:n.jobPost.hiringCompanyWebsite,salaryMin:n.jobPost.salaryMin,salaryMax:n.jobPost.salaryMax,salaryType:n.jobPost.salaryType,expiresOn:r};n.jobPost.jobTitle!=""&&t.post("/api/Jobs/PostJob",item).success(function(t){n.jobPost.jobTitle="";i.path("/jobdetails/"+t.Id)})}}]);angular.module("register",[]).controller("registerCtrl",["$scope","$http",function(n,t){n.register=function(){var i={Email:n.username,Password:n.password1,ConfirmPassword:n.password2};t.post("/api/Account/Register",i).error(function(t){n.message=t.Message;n.showAlert=!0})};n.showAlert=!1}]);angular.module("signIn",["ngCookies"]).controller("signInCtrl",["$scope","$http","$cookies","$cookieStore","$location",function(n,t,i,r){n.signIn=function(){var i="grant_type=password&username="+n.username+"&password="+n.password;t({url:"/Token",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:i}).success(function(n){t.defaults.headers.common.Authorization="Bearer "+n.access_token;r.put("_Token",n.access_token);window.location="#/maindashboard"}).error(function(t){n.message=t.error_description;n.showAlert=!0})};n.showAlert=!1}]);angular.module("todoManager",[]).controller("todoManagerCtrl",["$scope","$http",function(n,t){n.getList=function(){t.get("/api/WS_Todo/GetUserTodoItems").success(function(t){n.todoList=t})};n.postItem=function(){item={task:n.newTaskText};n.newTaskText!=""&&t.post("/api/WS_Todo/PostTodoItem",item).success(function(){n.newTaskText="";n.getList()})};n.complete=function(i){t.post("/api/WS_Todo/CompleteTodoItem/"+n.todoList[i].id).success(function(){n.getList()})};n.delete=function(i){t.post("/api/WS_Todo/DeleteTodoItem/"+n.todoList[i].id).success(function(){n.getList()})};n.getList()}])